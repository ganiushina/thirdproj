<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">

    <title>Акты</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <style>
        input:required {
            background-color: red;
        }
        /*select:required {*/
        /*    background-color: red;*/
        /*}*/
    </style>

</head>
<body>

<div th:replace="~{navigation :: navi(Shop)}"/>

<div class="container">

    <br>

    <h1 th:text="Акты" />

    <p th:text="Акт  + ' ' + для + ' '  + ${employer.ManFIO}" >

    <br>

    <form th:action="@{/act/allact}" th:object="${actList}" method="post">
<!--    <input type="hidden" th:field="${actList}" name="actList"/>-->

    <table id = "myTable" class="table table-hover">
        <tr>
            <th>Процент</th>
            <th>Компания</th>
            <th>Кандидат</th>
            <th>Сумма без НДС</th>
<!--            <th>Сотрудник</th>-->
        </tr>

        <tbody>

        <tr class='container' th:each="act,iterStat : ${actList}">

            <div>
                <td>
                    <input type="checkbox" name="act" th:value="${act.id}" th:checked="${act.paid} ? 'checked'" />

                    <input type="number" id="percent"  step="0.5" min="0" max="100"  style="width: 50px; height: 25px;"
                           name="percent"
                           th:value="${act.percent != null} ? ${act.percent}"/>
                </td>
            </div>

            <td th:text="${act.companies}"/>
            <td th:text="${act.candidate}"/>
            <td th:text="${act.bonus}"/>

<!--            <td>-->

<!--            <select multiple id="employer" name="manIds" size="10" >-->
<!--                <option th:each="employer : ${employers}"-->
<!--                        th:value="${employer.manId}"-->
<!--                        th:text="${employer.manFIO}">-->
<!--                </option>-->
<!--            </select>-->
<!--            </td>-->

<!--        </tr>-->
        </tbody>
        <input hidden type="text" name="fio" th:value="${employer.ManFIO}"/>

        <input hidden name="actList" th:value="${actList}"/>

        <button disabled type="submit" id="buttonID" name="request"
                th:value="${requestParam}"
                class="btn btn-primary">Готово</button>
    </table>


    </form>

</div>
<script>
    $('input[type="number"]').change(function(){
        $(this).siblings('input[type="checkbox"]').prop('checked', true);
        let thisval = $(this).val();

        if (thisval == 0){
            $(this).siblings('input[type="checkbox"]').prop('checked', false);
            $(this).prop('required', false);
        }
        else {
            $(this).siblings('input[type="checkbox"]').prop('checked', true);
          //  $(this).closest("tr").find('select').attr('required', true);
        }
        $("#buttonID").attr("disabled", false);
    });

   $('input[type="checkbox"]').change(function(){
       var checked = $(this).is(':checked');
       var input = $(this).closest('tr').find('input[type="number"]');
   //    $(this).closest("tr").find('select').attr('required', checked);

       var d = input.val();
       if (d == 0){
           input.prop("required", checked);
           $("#buttonID").attr("disabled", true );
       }
       else $("#buttonID").attr("disabled", false);

   })

</script>


</body>
</html>