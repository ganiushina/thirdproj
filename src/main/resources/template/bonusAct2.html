<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<html xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        ul {
            list-style-type: none;
            padding: 0px;
        }
        table td{
            text-align: left;
        }
        .tbl{
            padding: 10px;
        }

        .navigation {
            padding-left: 10px;

        }

    </style>
    <meta charset="utf-8"/>

    <title>Бонусы</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

    <!-- Optional theme -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>   >

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">



</head>

<body>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

<div th:replace="~{navigation :: navi(Cart)}"></div>



<div  class="tbl">

    <h1 th:text="Акты"/>

    <p th:text="Всего  + ' ' + неоплачено + ' ' + актов + ': '  + ${allActMoney}">

    <p th:text="Всего  + ' ' + выставлено  + ' ' + актов + ' ' + за + ' ' + период  +': '  + ${allActForClientMoneyPeriod}">

    <p th:text="Выставлено  + ' ' + актов + ' ' + за + ' ' + период + ' ' + по + ' ' + компаниям + ': '  + ${allActForClientMoneyPeriodByCompanyString}">

    <p th:text="Неоплачено  + ' ' + актов + ' ' + за + ' ' + период +': '  + ${allActMoneyPeriod}">

    <p th:text="Оплачено  + ' ' + актов + ' ' + за + ' ' + период +': '  + ${allActMoneyPeriodPaid}">

    <p th:text="Ожидается  + ' ' + выходов + ' ' + на + ' ' + сумму +': '  + ${allFinalistMoneyPeriodPaid}">


    <form th:action="@{/actPut/actAll}" method="get">

        <input required th:value="${date1 != null} ? ${date1}" th:name="date1" type="date"
               placeholder="Дата от ">
        <input required th:value="${date2 != null} ? ${date2}" th:name="date2" type="date"
               placeholder="Дата до">


        <input type="text" id="inputAct" onkeyup="myFunction()" placeholder="Поиск по номеру акта.." title="Type in a act num">
        <input type="text" id="inputCandidate" onkeyup="searchCandidate()" placeholder="Поиск по кандидату.." title="Type in a candidate">
        <input type="text" id="inputProject" onkeyup="searchProject()" placeholder="Поиск по проекту.." title="Type in a project">
        <input type="text" id="inputCompany" onkeyup="searchCompany()" placeholder="Поиск по компании.." title="Type in a company">

        <button type="submit" class="btn btn-primary">Фильтровать</button>

    </form>
</div>
<div>
    <nav class="navigation">
        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">

            <li class="active">
                <button href="#tab-table1" data-toggle="tab">Акты за период</button>
            </li>

            <li>
                <button href="#tab-table2" data-toggle="tab">Все неоплаченные акты</button>
            </li>
            <li>
                <button href="#tab-table3" data-toggle="tab">Ожидается выходов</button>
            </li>

        </ul>
    </nav>
</div>

                <div class="container-fluid">

                <div class="tab-content">

                        <div class="tab-pane active" id="tab-table1">

                            <table id="example1" class="table table-bordered border-primary">

                                <thead>
                                    <tr>
                                        <th>От компании</th>
                                        <th>Номер акта</th>
                                        <th>Дата акта</th>
                                        <th>Компания</th>
                                        <th>Сумма</th>
                                        <th>Кандидат</th>
                                        <th>Проект</th>
                                        <th>Оплата</th>
                                        <th>Дата оплаты</th>
                                        <th>Оплата до</th>
                                    </tr>
                                    </thead>

                                    <tbody>

                                    <tr th:each="act,iterStat : ${actPutList}">
                                        <td style="white-space: nowrap" th:text="${act.organization}"/>
                                        <td style="white-space: nowrap" th:text="${act.num}"/>
                                        <td style="white-space: nowrap" th:text="${act.date}"/>

                                        <td style="white-space: nowrap" th:text="${act.companies}"/>
                                        <td th:text="${act.bonusRUB}"/>
                                        <td style="white-space: nowrap" th:text="${act.candidate}"/>
                                        <td style="white-space: nowrap" th:text="${act.projectName}"/>


                                        <td class="paid" style="white-space: nowrap" th:text="${act.paid}"/>
                                        <td style="white-space: nowrap" th:text="${act.datePayment}"/>
                                        <td style="white-space: nowrap" th:text="${act.dateClientPay}"/>
                                    </tr>

                                    </tbody>


                                </table>
                        </div>

                        <div class="tab-pane" id="tab-table2">


                            <table id="example2" class="table table-bordered border-primary">
                                <thead>
                                <tr>
                                    <th>Номер акта</th>
                                    <th>Дата акта</th>
                                    <th>Компания</th>
                                    <th>Сумма</th>
                                    <th>Кандидат</th>
                                    <th>Проект</th>
                                    <th>Оплата до</th>
                                </tr>
                                </thead>

                                <tbody>

                                <tr th:each="act,iterStat : ${actNoPayList}">
                                    <td style="white-space: nowrap"  th:text="${act.num}"/>
                                    <td style="white-space: nowrap"  th:text="${act.date}"/>

                                    <td style="white-space: nowrap"  th:text="${act.companies}"/>
                                    <td style="white-space: nowrap"  th:text="${act.bonusRUB}"/>
                                    <td style="white-space: nowrap"  th:text="${act.candidate}"/>
                                    <td style="white-space: nowrap"  th:text="${act.projectName}"/>

                                    <td style="white-space: nowrap" th:text="${act.dateClientPay}"/>
                                </tr>
                                </tbody>

                            </table>
                        </div>



                    <div class="tab-pane" id="tab-table3">


                        <table id="example3" class="table table-bordered border-primary">
                            <thead>
                            <tr>
                                <th>Компания</th>
                                <th>Кандидат</th>
                                <th>Гонорар</th>
                                <th>Проект</th>
                                <th>Дата выхода</th>
                                <th>Отсрочка платежа</th>
                                <th>Оплата до</th>
                            </tr>
                            </thead>

                            <tbody>

                            <tr th:each="finalist,iterStat : ${moneyByFinalists}">
                                <td style="white-space: nowrap"  th:text="${finalist.companyName}"/>
                                <td style="white-space: nowrap"  th:text="${finalist.manFio}"/>
                                <td style="white-space: nowrap"  th:text="${finalist.projectFeeRUB}"/>
                                <td style="white-space: nowrap"  th:text="${finalist.projectName}"/>
                                <td style="white-space: nowrap"  th:text="${finalist.recruitingToWorkString}"/>
                                <td style="white-space: nowrap"  th:text="${finalist.projectDelayPay}"/>
                                <td style="white-space: nowrap" th:text="${finalist.recruitingMoneyToWork}"/>
                            </tr>
                            </tbody>

                        </table>
                    </div>

                </div>

            </form>





</div>
</div>


<script>

    $("table tbody").each(function() {
        $(this).find(".build-name").attr("rowspan", $(this).find("tr").length)
    })

    function myFunction() {
        var input, filter, table, table1, tr, tr1, td, td1, i, j;
        input = document.getElementById("inputName");
        filter = input.value.toUpperCase();
        table = document.getElementById("myTable");
        tr = table.getElementsByTagName("tr");

        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[0];
            if (td) {
                if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }

        table1 = document.getElementById("myTable2");
        tr1 = table1.getElementsByTagName("tr");

        for (j = 0; j < tr1.length; j++) {
            td1 = tr1[j].getElementsByTagName("td")[0];
            if (td1) {
                if (td1.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr1[j].style.display = "";
                } else {
                    tr1[j].style.display = "none";
                }
            }
        }
    }

    function searchDep() {
        var input, filter, table, table1, tr, tr1, td, td1, i, j;
        input = document.getElementById("inputDepartment");
        filter = input.value.toUpperCase();
        table = document.getElementById("myTable");
        tr = table.getElementsByTagName("tr");

        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[2];
            if (td) {
                if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }

        table1 = document.getElementById("myTable2");
        tr1 = table1.getElementsByTagName("tr");

        for (j = 0; j < tr1.length; j++) {
            td1 = tr1[j].getElementsByTagName("td")[2];
            if (td1) {
                if (td1.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr1[j].style.display = "";
                } else {
                    tr1[j].style.display = "none";
                }
            }
        }
    } $(document).ready(function () {

        var table1 = $('#example1').DataTable({
            responsive: true,

        });

        var table2 = $('#example2').DataTable({
            responsive: true,

        });

        $('button[data-bs-toggle="tab"]').on('shown.bs.tab', function (event) {
            var tabID = $(event.target).attr('data-bs-target');
            if (tabID === '#profile') {
                table2.columns.adjust().responsive.recalc();
            }
        });

    });

    function myFunction() {
        var input, filter, table, table1, tr, tr1, td, td1, i, j;
        input = document.getElementById("inputAct");
        filter = input.value.toUpperCase();
        table = document.getElementById("example1");
        tr = table.getElementsByTagName("tr");

        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[0];
            if (td) {
                if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }

        table1 = document.getElementById("example2");
        tr1 = table1.getElementsByTagName("tr");

        for (j = 0; j < tr1.length; j++) {
            td1 = tr1[j].getElementsByTagName("td")[0];
            if (td1) {
                if (td1.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr1[j].style.display = "";
                } else {
                    tr1[j].style.display = "none";
                }
            }
        }
    }

    function searchCandidate() {
        var input, filter, table, table1, tr, tr1, td, td1, i, j;
        input = document.getElementById("inputCandidate");
        filter = input.value.toUpperCase();
        table = document.getElementById("example1");
        tr = table.getElementsByTagName("tr");

        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[3];
            if (td) {
                if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }

        table1 = document.getElementById("example2");
        tr1 = table1.getElementsByTagName("tr");

        for (j = 0; j < tr1.length; j++) {
            td1 = tr1[j].getElementsByTagName("td")[3];
            if (td1) {
                if (td1.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr1[j].style.display = "";
                } else {
                    tr1[j].style.display = "none";
                }
            }
        }
    }



    function searchProject() {
        var input, filter, table, table1, tr, tr1, td, td1, i, j;
        input = document.getElementById("inputProject");
        filter = input.value.toUpperCase();
        table = document.getElementById("example1");
        tr = table.getElementsByTagName("tr");

        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[4];
            if (td) {
                if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }

        table1 = document.getElementById("example2");
        tr1 = table1.getElementsByTagName("tr");

        for (j = 0; j < tr1.length; j++) {
            td1 = tr1[j].getElementsByTagName("td")[4];
            if (td1) {
                if (td1.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr1[j].style.display = "";
                } else {
                    tr1[j].style.display = "none";
                }
            }
        }
    }

    function searchCompany() {
        var input, filter, table, table1, tr, tr1, td, td1, i, j;
        input = document.getElementById("inputCompany");
        filter = input.value.toUpperCase();
        table = document.getElementById("example1");
        tr = table.getElementsByTagName("tr");

        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[2];
            if (td) {
                if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }

        table1 = document.getElementById("example2");
        tr1 = table1.getElementsByTagName("tr");

        for (j = 0; j < tr1.length; j++) {
            td1 = tr1[j].getElementsByTagName("td")[2];
            if (td1) {
                if (td1.innerHTML.toUpperCase().indexOf(filter) > -1) {
                    tr1[j].style.display = "";
                } else {
                    tr1[j].style.display = "none";
                }
            }
        }
    }

    $('.paid').each(function(){
        if($(this).text() == 'true'){
            $(this).parent().css({'background-color' : '#89e289'})
        }
        else{
            $(this).parent().css({'background-color' : '#f08080'})
        }
    });


</script>

</body>
</html>